# Internet Protocol(IP)

+ 在 TCP/IP Protocol Suite 的 internet 層上運作

+ 採用無連接協議 (connectionless protocol) 傳輸數據，其訊號發出前無須確認接收端是否就緒，甚至是否存在接收端

+ 每個封包都是獨立的

+ 分層定址 (hierarchical addressing)，IP 由 網段、子網段、主機位址分層構成

+ 盡力傳送的 (best-effort delivery)，但不對結果進行保證

+ 沒有資料復原能力

+ 與傳輸媒介無關

+ 有 IPv4 與 IPv6 兩種

# IPv4 Address Representation

+ 一個IP位址總長為 32bits

+ 分為 Network ID 與 Host ID 兩部分

+ Address class

  + Class A: 第 1 個 bit 是 0，前 8 個 bit 是 Network ID
    
    + Public IP range: 1.0.0.0 - 9.255.255.255 & 11.0.0.0 - 126.255.255.255

    + Private IP range: 10.0.0.0/8

  + Class B: 前 2 個 bits 是 10，前 16 個 bit 是 Network ID

    + Public IP range: 128.0.0.0 - 172.15.255.255 & 172.32.0.0 - 191.255.255.255

    + Private IP range: 172.16.0.0/12

  + Class B: 前 3 個 bits 是 110，前 32 個 bit 是 Network ID

    + Public IP range: 192.0.0.0 - 192.167.255.255 & 192.169.0.0 - 233.255.255.255

    + Private IP range: 192.168.0.0/16

+ IP 位址與子網路遮罩進行 AND 運算就可得網路位址 (network address)

+ 假設原本的網路位址為 192.168.52.0/24，若想再切割子網路可用借位 (borrowing bits) 的方式

    24 = 11111111.11111111.11111111.00000000

    1. 多借 1 位 25 = 11111111.11111111.11111111.10000000

        此時多了 1 個子網 bit，表示可切出 2^1 = 2 個子網，每個子網有 2^(8 - 1) - 2 = 126 個主機位址

        然後 borrowing bits 在 IP 的第 4 個區段的第 8 個 bit，也就是每 2^7 = 128 切出一個網段(第 1 個 bit 是 2^0 = 1)，切出來的兩個子網的網路位址會從原本的 0 開始為 192.168.52.0，第二個子網的網路位址為 192.168.52.128

    2. 多借 5 位 29 = 11111111.11111111.11111111.11111000

        此時多了 5 個子網 bit，表示可切出 2^5 = 32 個子網，每個子網有 2^(8 - 5) - 2 = 6 個主機位址

        然後 borrowing bits 在 IP 的第 4 個區段的第 4 個 bit，也就是每 2^3 = 8 切出一個網段，切出來的兩個子網的網路位址會從原本的 0 開始為 192.168.52.0, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248 共 32 個網路位址